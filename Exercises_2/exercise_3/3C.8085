START: 
IN 10H ;DISABLE MEMORY PROTECTION
LXI H,0A00H ;SET UP STACK POINTER
MVI B,04H ;SET UP LOOP COUNTER

PROGRAM_LOOP:
MVI M,10H 
INX H ;INCREMENT HL VALUE
DCR B ;DECREMENT LOOP COUNTER
JNZ PROGRAM_LOOP ;LOOP BACK IF NOT DONE

LINE_0:
MVI A,FEH ;READ PORT 1800H
STA 2800H 
LDA 1800H 
ANI 07H ; 3 LSB
MVI C,86H 
CPI 06H ;INSTR STEP
JZ OUTPUT
MVI C,85H
CPI 05H ;STEP PC
JZ OUTPUT 
;WE IGNORE HDWR STEP

LINE_1:
MVI A,FDH
STA 2800H
LDA 1800H
ANI 07H
MVI C,84H
CPI 06H ; THIS IS RUN
JZ OUTPUT
MVI C,80H
CPI 05H ; REGISTER FETCH
JZ OUTPUT
MVI C,82H
CPI 03H ;ADDRESS FETCH
JZ OUTPUT

LINE_2:
MVI A,FBH
STA 2800H
LDA 1800H
ANI 07H
MVI C,00H ;THIS IS 0
CPI 06H ; 
JZ OUTPUT
MVI C,83H
CPI 05H ; INCREMENT | STORE
JZ OUTPUT
MVI C,81H
CPI 03H ;DECREMENT
JZ OUTPUT

LINE_3: ;SIMILAR TO MANUAL PAGES 80-82
MVI A,F7H 
STA 2800H
LDA 1800H
ANI 07H
MVI C,01H ;1
CPI 06H ; THIS IS 1
JZ OUTPUT
MVI C,02H ;2
CPI 05H ; THIS IS 2 
JZ OUTPUT
MVI C,03H ;3
CPI 03H ; THIS IS 3 
JZ OUTPUT

LINE_4: 
MVI A,EFH 
STA 2800H
LDA 1800H
ANI 07H
MVI C,04H ;4
CPI 06H ; THIS IS 4
JZ OUTPUT
MVI C,05H ;5
CPI 05H ; THIS IS 5 
JZ OUTPUT
MVI C,06H ;6
CPI 03H ; THIS IS 6 
JZ OUTPUT

LINE_5:	
MVI A,DFH
STA 2800H	
LDA 1800H	 
ANI 07H		
MVI C,07H ;7
CPI 06H	 ; THIS IS 7
JZ OUTPUT
MVI C,08H ;8
CPI 05H	; THIS IS 8
JZ OUTPUT
MVI C,09H ;9
CPI 03H	; THIS IS 9
JZ OUTPUT

LINE_6: 
MVI A,BFH
STA 2800H
LDA 1800H
ANI 07H
MVI C,0AH ;A
CPI 06H ; THIS IS A
JZ OUTPUT
MVI C,0BH ;B
CPI 05H ; THIS IS B 
JZ OUTPUT
MVI C,0CH ;C
CPI 03H ; THIS IS C 
JZ OUTPUT

LINE_7: 
MVI A,7FH 
STA 2800H
LDA 1800H
ANI 07H
MVI C,0DH ;D
CPI 06H ; THIS IS D
JZ OUTPUT
MVI C,0EH ;E
CPI 05H ; THIS IS E 
JZ OUTPUT
MVI C,0FH ;F
CPI 03H ; THIS IS F 
JZ OUTPUT
JMP START ;LOOP BACK BECAUSE NO KEY PRESSED :))

OUTPUT:	
LXI H,0A04H		
MOV A,C		
ANI 0FH		
MOV M,A		
INX H			
MOV A,C		
ANI F0H		
RLC
RLC			
RLC
RLC	
MOV M,A		
LXI D,0A00H		
CALL STDM	
CALL DCD		
JMP START		
END